<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Vencimientos - Rutek Tours</title>
    <style>
        body { font-family: Arial, sans-serif; background-color: #f4f4f4; margin: 0; }
        header {
            background-color: #1f2937; color: #fff; padding: 15px 25px;
            display: flex; justify-content: space-between; align-items: center;
        }
        header a { color: #f97316; text-decoration: none; font-weight: bold; }
        main { padding: 20px 25px; }
        h1 { margin-top: 0; }

        .toolbar {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 15px;
        }

        input[type="number"] {
            padding: 4px 6px; border-radius: 4px; border: 1px solid #d1d5db;
            width: 70px;
        }
        button {
            padding: 6px 10px; border-radius: 4px; border: none; cursor: pointer;
            font-size: 13px; font-weight: bold;
        }
        .btn-primary { background-color: #2563eb; color: #fff; }

        table {
            width: 100%; border-collapse: collapse; background-color: #fff;
        }
        th, td {
            padding: 8px 10px; border-bottom: 1px solid #e5e7eb; font-size: 13px;
        }
        th { text-align: left; background-color: #f9fafb; }
        tr:hover { background-color: #f3f4f6; }

        .badge {
            font-size: 12px; font-weight: bold; padding: 2px 6px; border-radius: 4px;
        }
        .badge-vencido { background-color: #fee2e2; color: #b91c1c; }
        .badge-porvencer { background-color: #fef9c3; color: #92400e; }
    </style>
</head>
<body>

<header>
    <div><strong>Rutek Tours</strong> – Vencimientos de documentos</div>
    <div><a href="{% url 'dashboard' %}">Volver al dashboard</a></div>
</header>

<main>
    <div class="toolbar">
        <h1>Vencimientos en {{ dias_alerta }} días</h1>

        <form method="get">
            <label>Días a futuro:&nbsp;</label>
            <input type="number" name="dias" min="1" max="365" value="{{ dias_alerta }}">
            <button type="submit" class="btn-primary">Actualizar</button>
        </form>
    </div>

    <table>
        <thead>
            <tr>
                <th>Tipo</th>
                <th>Elemento</th>
                <th>Documento</th>
                <th>Fecha de vencimiento</th>
                <th>Días</th>
                <th>Estado</th>
            </tr>
        </thead>
        <tbody>
            {% if alertas %}
                {% for a in alertas %}
                    <tr>
                        <td>
                            {% if a.origen == "CONDUCTOR" %}
                                Conductor
                            {% else %}
                                Vehículo
                            {% endif %}
                        </td>

                        <td>
                            {% if a.origen == "CONDUCTOR" %}
                                {{ a.nombre }}<br>
                                <small>Doc: {{ a.identificacion }}</small>
                            {% else %}
                                {{ a.placa }}<br>
                                <small>{{ a.descripcion }}</small>
                            {% endif %}
                        </td>

                        <td>{{ a.tipo }}</td>
                        <td>{{ a.fecha|date:"d/m/Y" }}</td>

                        <!-- usamos dias_texto que ya viene en positivo -->
                        <td>{{ a.dias_texto }}</td>

                        <td>
                            {% if a.estado_alerta == "VENCIDO" %}
                                <span class="badge badge-vencido">Vencido</span>
                            {% else %}
                                <span class="badge badge-porvencer">Por vencer</span>
                            {% endif %}
                        </td>
                    </tr>
                {% endfor %}
            {% else %}
                <tr>
                    <td colspan="6">No hay documentos vencidos ni por vencer en este rango.</td>
                </tr>
            {% endif %}
        </tbody>
    </table>
</main>

</body>
</html>

